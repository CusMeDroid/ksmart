<!DOCTYPE html>
<html lang="id-ID">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>KSMART SAKLAR JARAK JAUH</title>
    <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase.js"></script>
  </head>
  <body>
    <h1>Daya</h1>
    <button id="btnon">Hidup</button>
    <button id="btnoff">Mati</button>
    <br><br>
    <lable>Teks</lable><br>
    <input type="text" id="mydesc" maxlength="16"><br><br>
    <button id="btnsave">Simpan</button>
    <button id="btnlogout">Keluar</button>
    
    <script src="js/config/index.js"></script>
    <script src="js/storage/index.js"></script>
    <script>
      if (!sessionEmail && !sessionUid) {
        window.location.href = "login.html";
      }
      document.getElementById("btnon").onclick = function () {
        var relaystat = "on";
        firebase
          .database()
          .ref("users/"+sessionUid)
          .update({
            relay: relaystat,
          });
        alert("Daya Aktif");
      };

      document.getElementById("btnoff").onclick = function () {
        var relaystat = "off";
        firebase
          .database()
          .ref("users/"+sessionUid)
          .update({
            relay: relaystat,
          });
        alert("Daya Mati");
      };

      document.getElementById("btnsave").onclick = function () {
        var mDesc = document.getElementById("mydesc").value;
        if (mDesc < 1) {
          alert("Jangan kosong");
        } else {
          firebase
            .database()
            .ref("users/"+sessionUid)
            .update({
              desc: mDesc,
            });
          alert("Teks berhasil diubah");
          document.getElementById("mydesc").value="";
        }
      };
      
      document.getElementById("btnlogout").onclick = function () {
        firebase.auth().signOut().then(() => {
          var relaystat = "off";
          firebase
            .database()
            .ref("users/"+sessionUid)
            .update({
              relay: relaystat,
            });
          localStorage.clear();
          window.location.href = "";
        }).catch((error) => {
          // An error happened.
        });
      };
    </script>
    
  </body>
</html>
